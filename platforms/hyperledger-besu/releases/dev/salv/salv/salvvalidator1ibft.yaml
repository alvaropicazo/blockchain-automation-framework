apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: salvvalidator1ibft
  namespace: salv-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: salvvalidator1ibft
  chart:
    git: https://github.com/alvaropicazo/blockchain-automation-framework.git
    ref: feature-1543
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://028938c856a91fb464144af070db922818c8c80808c6882647181448bc503037299260393921126288608571d7f55a010a66df8cf06d9246267e9d81022aefed@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15011"
      
      - "enode://4edf17a3c18799d38203d323da125ad58c7a3f6e80222c0baa8a117fd6d809eab2d80a6c00b456f1e110e917f45b85d79738c778587c5e0ed38b0548945b8e31@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15013"
      
      - "enode://09d10cbb8e57d68dd4ec0eab5dc22a50740f182bde94795342fd0287236ee75b2d8427985075339289304d4b1ef2797923372eafa15a5735997afe349eb16250@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15015"
      
      - "enode://bdb415642f4bd6e62cb23f21e07d99f0fa242136675492a669b869567045747568a07d855fea564bf98875267833f4776bcbf8c3875877fdddf5a5cddcfa1b26@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15017"
      
      - "enode://afb323ee085e1ca14ba94898e8c53bfee4661f22e68b5d50e4811c3e62da11a73b2e26d4cff6000cce04173eb7fe091ccda8c1e71b44bcafa091e204c5750a33@calv.bes.dev2.aws.blockchaincloudpoc-develop.com:15010"
      
      - "enode://eafb82fec381c260e5195962c32bf55c264cc61e2f40a8faeeb56ddeaa125bbb60d6cb2464382bfb43b5c589768223379e3fdda78a0967c584eae9821f24fd6a@malv.bes.dev2.aws.blockchaincloudpoc-develop.com:15013"
      

    metadata:
      namespace: salv-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false

    proxy:
      provider: ambassador
      external_url: salv.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15011
      rpc: 15012

    images:
      node: hyperledger/besu:1.5.5
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator1
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secret/salv-bes/crypto/validator1
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusalv

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDEzMDliYjA0ZmI3ZjYwZmM4MTc2OWIxMWNjNjcyMDRmZmRiNzVhYjM5NGUyZTA4Zjk0NDQ2YjU1ZmExOTIxNWZkN2EwNzdjNDFlYzBjZTI3OGQ5NDkzNzNkNzBjMzgyMTk4YTRlOTBkNWU1NGJlOTFlYjAxYzZlNDQ2OGI5NGI5YWQ4Zjg5YWNjOGJmYjUxOTVmZjc0NjRjNzA5NWI2NmRlM2MxMDY4MDg0MDAwMDAwMDBjMCIKfQ==
