apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: salvvalidator2ibft
  namespace: salv-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: salvvalidator2ibft
  chart:
    git: https://github.com/alvaropicazo/blockchain-automation-framework.git
    ref: testfeat1551check
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://039992be5601160661fe58abbed9f9cf1361ebc3d1536c068af88e331fa3e6e4f3665cbbf4bef18e33323c5e172d409385773c4cbf4b6de6273dc0515ebb26ba@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15011"
      
      - "enode://22f180de4fa9ecb5600812cedb59613100e05a779c026f76a6cff2b263ce07e95a25b90872a3c7ca4f59f499245138c9b112b69ef3ebae429c19984b5e14fe9b@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15013"
      
      - "enode://93aeeed3492919354327a1a1db730d5839fb199bcf847ed47b7ac1fa12d8e53aca91513c3dae4392af630235772608332f6908c3e1c5e5f9e2a639e0e5150ef8@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15015"
      
      - "enode://2cd3f9657db043bad78bee506b0470f1c7a5ac02a550f1e43fb665b138de4533a41e4d7817177ec43d0a8e869220d2f0b5f8794a2f0ff2e6bfd3f21b3c748e63@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15017"
      
      - "enode://d8cea130430bf45fb64d61fb2af62e17566e0693ff2457c2675b0e0148472846697c5d1142d614abdbb55673439e4ba9f268e47a672f3bfe7f8315c7eddb7f52@calv.bes.dev2.aws.blockchaincloudpoc-develop.com:15010"
      
      - "enode://4b5b2496c89200a6fa9b8d8c65ca8278212a5fd58962efe3b6d12f9138a6258d9646ddcdb583ac6507edee65a6fd3e9df2de395ae5bdaf93f6a5c1bf5465bcf7@malv.bes.dev2.aws.blockchaincloudpoc-develop.com:15013"
      

    metadata:
      namespace: salv-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: salv.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15013
      rpc: 15014

    images:
      node: hyperledger/besu:1.5.5
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator2
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secretsv2/data/salv-bes/crypto/validator2
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusalv

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGUwMmEyNDUwYmRjNzc4NjU2YjA1NGE5YzA1YzUzZjIxMDY4YjRiYmI5NDkyYTdkYWNhMzQ1ZGYwMDUzZWRhMzMzNDg4ZmM3YmU0NTNiMzY2Njg5NDVmZGVhMTQ1MDY2NjRkNjU0N2ZlZjM4Njg5MTcyMGIyZGYyMDBhOWM5NDU0OTE0MGY0ZDZlZDg3YTA0MmNlMjk1Yzk0Njc0NDZhNGY5YmY1ZDM4MDg0MDAwMDAwMDBjMCIKfQ==
