apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: salvvalidator3ibft
  namespace: salv-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: salvvalidator3ibft
  chart:
    git: https://github.com/alvaropicazo/blockchain-automation-framework.git
    ref: feature-1017
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://de0da331f1633cd1de986e3cc89ac5f17d54294876da9003981c55980367d1f9d424ca7b6f935a207c80b7a8f709df1014acef63e0ba9ef8c3ed2e1e4296301e@validator1.rc.dev2.aws.blockchaincloudpoc-develop.com:15030"
      - "enode://af78ca90f85f0c5210b94082e1add3933a3cc9b99d6a2d4eee394cf11724e23ddb80328afd7ce5000f52cbc15a9947234fda83f5eb8209d4376e882cc0f57fd7@validator2.rc.dev2.aws.blockchaincloudpoc-develop.com:15032"
      - "enode://a56b67b6104f7f4f2c544a2d935f7315ed7fc96ef6dcd82f633477be2c13dcccaf8ff30ad5a3b5acf505661f3c7e6e6c31c1f9335650062a006221d23a115324@validator3.rc.dev2.aws.blockchaincloudpoc-develop.com:15034"
      - "enode://8d319e04f1a2d2713a4e66d76e5a71bb453bae53e9c0608bf09bd35e9bd56b9bf11f395c3e32779facb85c96b45b37b7cfbf376a04946c862c8a69317b0b7600@validator4.rc.dev2.aws.blockchaincloudpoc-develop.com:15036"
      - "enode://@validator5.rc.dev2.aws.blockchaincloudpoc-develop.com:15038"

    metadata:
      namespace: salv-bes
      labels:

    ambassador:
      external_url_suffix: rc.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false

    proxy:
      provider: ambassador
      external_url: salv.rc.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15034
      rpc: 15035

    images:
      node: hyperledger/besu:1.5.5
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator3
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev2.aws.blockchaincloudpoc-develop.com:20001
      secretprefix: secret/salv-bes/crypto/validator3
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusalv

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDVmN2MxNDZhYTJmNWNhNDc1OWI1Y2ExOTA1ZWZjYzY5NGFkZTdlMzM5NDVhMjVjMjNiMjNjZmE4N2VlNmE0NjI4YTY1NWViNjlhMTE4OTI1ZWU5NDlhNWRkN2E3OWRmZWFkNzRlMmZlZDY0YzBkOGFjYTBmYWFhN2E3Yzg5NGI1NjcyMTVhODViOGQwZWQ5MmRlYTUyOWQ3YThmZTQ5YTgyNzRhOTI4MDg0MDAwMDAwMDBjMCIKfQ==
